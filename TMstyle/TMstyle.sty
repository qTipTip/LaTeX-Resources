\RequirePackage{fontspec}
\RequirePackage{listings}
\RequirePackage{mdframed}
\RequirePackage{calc} % provides arithmetic
\RequirePackage[usenames, dvipsnames, svgnames, table]{xcolor}
\RequirePackage{array}
\RequirePackage{tabu}
\RequirePackage{longtable}

% CODE LISTING

\newcommand{\codeTitle}[2]{Code}
\newcommand{\codeTitleContent}{%
    \hspace*{3mm}
    \begin{minipage}{0.75cm}
        \includegraphics[width=\linewidth]{images/code.png}
    \end{minipage}
    \hspace*{1mm}
    \begin{minipage}{\textwidth-1.05cm} % this only works with calc package
        {\sffamily\Large \codeTitle}
    \end{minipage}
}

\definecolor{color1}{RGB}{124, 191, 48}   % lime green
\definecolor{color2}{RGB}{243, 126, 25}% burnt orange
\definecolor{color3}{RGB}{230, 6, 85}% strawberry
\definecolor{header}{RGB}{211, 47, 0}
\definecolor{row1}{RGB}{230, 230, 230}
\definecolor{row2}{RGB}{240, 240, 240}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Font settings                    %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\defaultfontfeatures{Ligatures=TeX}
\setmonofont{Source Code Pro Light}[BoldFont=Source Code Pro]
\setmainfont{Lato Light}[
    Numbers=OldStyle,
    BoldFont=Lato Regular,
    ItalicFont=Lato Light Italic,
    BoldItalicFont=Lato Italic
]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Wraps the listings in an mdframe %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\definecolor{light-gray}{RGB}{230, 230, 230}
\BeforeBeginEnvironment{lstlisting}{%
    \begin{mdframed}[
            skipabove=4mm,
            skipbelow=0mm,
            %remove borders
            rightline=false,
            topline=false,
            bottomline=false,
            linewidth=1mm,
            %margins
            innertopmargin=2mm,
            innerleftmargin=0mm,
            innerbottommargin=0mm,
            innerrightmargin=10pt,
            backgroundcolor=light-gray,
            linecolor=Gray
        ]
        \codeTitleContent
        \vspace*{-2mm}
    }
\AfterEndEnvironment{lstlisting}{%
    \end{mdframed}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Sets listings specific options   %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\lstset{
    language=Python,
    showstringspaces=false,
    numbers=left,
    numbersep=7mm,
    numberstyle=\color{Black},
    stepnumber=1,
    tabsize=3,
    breakatwhitespace=false,
    breaklines=true,
    captionpos=b,
    basicstyle=\color{Black}\ttfamily,
    commentstyle=\color{color1},
    morecomment=[s]{"""}{"""},
    keywordstyle=\color{color2}\bfseries,
    stringstyle=\color{color3},
    frame=leftline,
    framesep=0mm,
    xleftmargin=3mm,
    framesep=2mm,
    framerule=0mm,
    abovecaptionskip=5mm,
    aboveskip=\baselineskip,
    belowskip=\baselineskip
}

% TABLES!

\everyrow{\tabucline[.4mm white]{}}
\tabulinesep=^4mm_3mm
\taburowcolors[2] 2{row1 .. row2}
\endinput

